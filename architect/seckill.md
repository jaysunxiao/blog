# 秒杀系统

## 一、设计原则
- 秒杀系统本质上就是一个满足大并发、高性能和高可用的分布式系统
```
1. 数据要尽量少
2. 请求数要尽量少
3. 路由要尽量短
4. 依赖要尽量少
5. 不要有单点
```

## 二、前端设计
- 动静分离
```
静态数据缓存到离用户最近的地方
一般我们都会对大流量的 Web 系统做静态化改造，让大部分请求和数据直接在 Nginx 服务器上直接返回，
而 Java 层只需处理少量数据的动态请求。针对这些请求，我们可以使用以下手段进行优化：
```

- 二八原则：缓存热点数据

## 三、后端设计
- 流量消峰：通过消息队列来缓冲请求，即控制请求的发出
- 使用缓存中间件，单台缓存服务器最多也就能支持30w qps
- 然后应用层采用“被动失效”的方式缓存一定时间（一般是数秒），失效后再去缓存拉取最新的数据。
- 分层校验：读的场景可以允许一定的脏数据，可以等到真正写数据时再保证最终的一致性，以上三种过滤到这层的请求已经很少了
- 异步通知：客户端轮询服务器的结果；或者和服务端建立连接websocket主动通知

```
系统服务端性能，一般用 QPS（Query Per Second，每秒请求数）来衡量。
还有一个影响和 QPS 也息息相关，那就是响应时间（Response Time，RT），它可以理解为服务器处理响应的耗时。
总 QPS =（1000ms / 响应时间）× 线程数量
```
